/**
 * Flipbook.js
 * ----------------------------------------------------------
 * Version: 1.0.2
 * Modified: 2012.10.16
 * Author: Kazy @ nbnote.jp
 * License: Dual licensed under the MIT and GPL licenses.
 * ----------------------------------------------------------
 */


(function(e,f){var g=function(b,c){this._screen=typeof b==='string'?f.getElementById(b):b instanceof jQuery?b[0]:b;this._frameList=[];this._style=this._screen.style;this._timer=0;this._speed=33;this._currentFrame=0;this._prevFrame=0;this._totalFrames=c.length;this._loop=true;this._isPlaying=false;this._isReverse=false;this.onLastFrame=function(a){};this.onFirstFrame=function(a){};this.onUpdate=function(a){};if(this._totalFrames){var d=f.createDocumentFragment(),frame,style,i=0,len=this._totalFrames;for(;i<len;i++){frame=new Image();frame.src=c[i];style=frame.style;style.display='block';style.visibility='hidden';style.position='absolute';style.top='0';style.left='0';d.appendChild(frame);this._frameList[i]=frame}this._screen.appendChild(d);this.setFrame(0)}};g.prototype={play:function(){var a=this;if(a._isPlaying&&!a._isReverse||a._totalFrames<2){return}a.pause();a._isPlaying=true;a._isReverse=false;a._timer=setInterval(function(){if(!a._loop&&a._currentFrame===a._totalFrames-1){a.pause()}else{a.setFrame(a._currentFrame+1)}},a._speed);a.setFrame(a._currentFrame+1)},replay:function(){this.stop();if(!this._isReverse){this.play()}else{this.reverse()}},reverse:function(){var a=this;if(a._isPlaying&&a._isReverse||a._totalFrames<2){return}a.pause();a._isPlaying=true;a._isReverse=true;a._timer=setInterval(function(){if(!a._loop&&a._currentFrame===0){a.pause()}else{a.setFrame(a._currentFrame-1)}},a._speed);a.setFrame(a._currentFrame-1)},pause:function(){if(!this._isPlaying)return;clearInterval(this._timer);this._isPlaying=false},stop:function(){this.pause();this.setFrame(0)},setFrame:function(a){this._prevFrame=this._currentFrame;var b=this._currentFrame=a>=this._totalFrames?0:a<0?this._totalFrames-1:a;this._frameList[this._prevFrame].style.visibility='hidden';this._frameList[b].style.visibility='visible';this.onUpdate({type:'update',frameNumber:b});if(b===0){this.onFirstFrame({type:'first_frame',frameNumber:b})}else if(b===this._totalFrames-1){this.onLastFrame({type:'last_frame',frameNumber:b})}},getSpeed:function(){return this._speed},setSpeed:function(a){this._speed=a},getLoop:function(){return this._loop},setLoop:function(a){this._loop=a},getCurrentFrame:function(){return this._currentFrame},getTotalFrames:function(){return this._totalFrames},isPlaying:function(){return this._isPlaying},isReverse:function(){return this._isReverse}};e.Flipbook=g}(window,document));


